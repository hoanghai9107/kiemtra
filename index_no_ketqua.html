
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Ki·ªÉm tra T·ª± lu·∫≠n K·∫ø to√°n</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; padding-top: 40px; }
    .card { margin-top: 20px; }
    textarea { resize: vertical; }
  </style>
</head>
<body>
  <div class="container">
    <h2 class="text-center mb-4">üìù B√†i ki·ªÉm tra T·ª± lu·∫≠n ‚Äì K·∫ø to√°n THPT</h2>

    <!-- Form nh·∫≠p th√¥ng tin h·ªçc sinh -->
    <div id="formThongTin" class="card shadow">
      <div class="card-body">
        <h5>üéì Nh·∫≠p th√¥ng tin h·ªçc sinh</h5>
        <div class="mb-3">
          <label class="form-label">H·ªç v√† t√™n</label>
          <input type="text" id="tenHS" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">M√£ s·ªë h·ªçc sinh</label>
          <input type="text" id="maSoHS" class="form-control" required>
        </div>
        <button class="btn btn-primary" onclick="batDau()">B·∫Øt ƒë·∫ßu l√†m b√†i</button>
      </div>
    </div>

    <!-- Giao di·ªán l√†m b√†i -->
    <div id="giaoDienBaiLam" class="d-none">
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          C√¢u h·ªèi <span id="soCau"></span>
        </div>
        <div class="card-body">
          <p id="cauHoi" class="fw-semibold"></p>
          <label for="traLoi" class="form-label">‚úçÔ∏è Nh·∫≠p c√¢u tr·∫£ l·ªùi:</label>
          <textarea id="traLoi" class="form-control" rows="5"></textarea>
          <div class="mt-3">
            <button class="btn btn-success" onclick="kiemTra()">Ki·ªÉm tra</button>
            <button class="btn btn-secondary d-none" id="btnTiep" onclick="cauTiepTheo()">Ti·∫øp theo</button>
          </div>
        </div>
      </div>

      <div id="ketQuaCard" class="card shadow mt-3 d-none">
        <div class="card-body">
          <h5 class="card-title">üìä K·∫øt qu·∫£:</h5>
          <p id="ketQua" class="card-text"></p>
        </div>
      </div>
    </div>


  </div>

  <script>
    const boDe = [
      {
        cauHoi: "Ph√¢n bi·ªát t√†i s·∫£n ng·∫Øn h·∫°n v√† t√†i s·∫£n d√†i h·∫°n trong k·∫ø to√°n.",
        dapAn: "T√†i s·∫£n ng·∫Øn h·∫°n l√† t√†i s·∫£n c√≥ th·ªùi gian s·ª≠ d·ª•ng ho·∫∑c thu h·ªìi trong v√≤ng m·ªôt nƒÉm. T√†i s·∫£n d√†i h·∫°n l√† t√†i s·∫£n c√≥ th·ªùi gian s·ª≠ d·ª•ng ho·∫∑c thu h·ªìi tr√™n m·ªôt nƒÉm."
      },
      {
        cauHoi: "Tr√¨nh b√†y kh√°i ni·ªám v√† vai tr√≤ c·ªßa b·∫£ng c√¢n ƒë·ªëi k·∫ø to√°n.",
        dapAn: "B·∫£ng c√¢n ƒë·ªëi k·∫ø to√°n l√† b√°o c√°o t√†i ch√≠nh ph·∫£n √°nh t√¨nh h√¨nh t√†i s·∫£n, n·ª£ ph·∫£i tr·∫£ v√† v·ªën ch·ªß s·ªü h·ªØu c·ªßa doanh nghi·ªáp t·∫°i m·ªôt th·ªùi ƒëi·ªÉm. N√≥ gi√∫p ƒë√°nh gi√° kh·∫£ nƒÉng t√†i ch√≠nh v√† c·∫•u tr√∫c t√†i s·∫£n c·ªßa doanh nghi·ªáp."
      },
      {
        cauHoi: "Chi ph√≠ s·∫£n xu·∫•t g·ªìm nh·ªØng y·∫øu t·ªë n√†o?",
        dapAn: "Chi ph√≠ s·∫£n xu·∫•t g·ªìm nguy√™n v·∫≠t li·ªáu tr·ª±c ti·∫øp, nh√¢n c√¥ng tr·ª±c ti·∫øp v√† chi ph√≠ s·∫£n xu·∫•t chung."
      },
      {
        cauHoi: "Tr√¨nh b√†y nguy√™n t·∫Øc ghi s·ªï k√©p trong k·∫ø to√°n.",
        dapAn: "Nguy√™n t·∫Øc ghi s·ªï k√©p y√™u c·∫ßu m·ªói nghi·ªáp v·ª• kinh t·∫ø ph·∫£i ƒë∆∞·ª£c ghi nh·∫≠n v√†o √≠t nh·∫•t hai t√†i kho·∫£n: m·ªôt t√†i kho·∫£n ghi N·ª£ v√† m·ªôt t√†i kho·∫£n ghi C√≥, v·ªõi t·ªïng s·ªë ti·ªÅn N·ª£ b·∫±ng t·ªïng s·ªë ti·ªÅn C√≥."
      }
    ];

    let chiSo = 0;
    let soCauDung = 0;
    let hocSinh = { ten: "", maSo: "" };

    function batDau() {
      const ten = document.getElementById("tenHS").value.trim();
      const maSo = document.getElementById("maSoHS").value.trim();

      if (!ten || !maSo) {
        alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin h·ªçc sinh.");
        return;
      }

      hocSinh.ten = ten;
      hocSinh.maSo = maSo;

      document.getElementById("formThongTin").classList.add("d-none");
      document.getElementById("giaoDienBaiLam").classList.remove("d-none");

      hienThiCauHoi();
    }

    function hienThiCauHoi() {
      document.getElementById("traLoi").value = "";
      document.getElementById("ketQua").innerText = "";
      document.getElementById("btnTiep").classList.add("d-none");
      document.getElementById("ketQuaCard").classList.add("d-none");

      if (chiSo < boDe.length) {
        document.getElementById("soCau").innerText = `${chiSo + 1} / ${boDe.length}`;
        document.getElementById("cauHoi").innerText = boDe[chiSo].cauHoi;
      } else {
        hienThiKetQuaTong();
      }
    }

    function tinhDoGiong(str1, str2) {
      const word1 = str1.toLowerCase().split(/\W+/);
      const word2 = str2.toLowerCase().split(/\W+/);
      const giong = word1.filter(w => word2.includes(w));
      return giong.length / Math.max(word1.length, word2.length);
    }

    function kiemTra() {
      const traLoi = document.getElementById("traLoi").value;
      const dapAn = boDe[chiSo].dapAn;
      const doGiong = tinhDoGiong(traLoi, dapAn);
      let danhGia = "";

      if (doGiong > 0.8) {
        danhGia = `<span class="text-success fw-bold">‚úÖ ƒê√∫ng!</span>`;
        soCauDung++;
      } else if (doGiong > 0.5) {
        danhGia = `<span class="text-warning fw-bold">üü° G·∫ßn ƒë√∫ng.</span> B·∫°n n√™n b·ªï sung th√™m n·ªôi dung.`;
      } else {
        danhGia = `<span class="text-danger fw-bold">‚ùå Sai.</span> G·ª£i √Ω: <em>${dapAn}</em>`;
      }

      document.getElementById("ketQua").innerHTML = danhGia;
      document.getElementById("btnTiep").classList.remove("d-none");
      document.getElementById("ketQuaCard").classList.remove("d-none");
    }

    function cauTiepTheo() {
      chiSo++;
      hienThiCauHoi();
    }

    function hienThiKetQuaTong() {
      const tong = boDe.length;
      const diem = ((soCauDung / tong) * 10).toFixed(1);

      const ketQuaCuoi = {
        ten: hocSinh.ten,
        maSo: hocSinh.maSo,
        soCauDung,
        tong,
        diem
      };

      localStorage.setItem("ketQuaKeToan", JSON.stringify(ketQuaCuoi));

      let danhSach = JSON.parse(localStorage.getItem("danhSachKetQua")) || [];
      danhSach.push(ketQuaCuoi);
      localStorage.setItem("danhSachKetQua", JSON.stringify(danhSach));

      document.querySelector(".container").innerHTML = `
        <div class="alert alert-success text-center" role="alert">
          üéâ <strong>${ketQuaCuoi.ten}</strong> (M√£ s·ªë: ${ketQuaCuoi.maSo})<br>
          B·∫°n ƒë√£ ho√†n th√†nh b√†i ki·ªÉm tra!<br>
          ‚úÖ S·ªë c√¢u ƒë√∫ng: ${ketQuaCuoi.soCauDung}/${ketQuaCuoi.tong} <br>
          üèÖ ƒêi·ªÉm: <strong>${ketQuaCuoi.diem}/10</strong>
        </div>`;
    }

    function xemKetQua() {
      const ds = JSON.parse(localStorage.getItem("danhSachKetQua")) || [];
      const tbody = document.getElementById("noiDungBang");
      tbody.innerHTML = "";

      if (ds.length === 0) {
        tbody.innerHTML = "<tr><td colspan='6' class='text-center'>Ch∆∞a c√≥ d·ªØ li·ªáu.</td></tr>";
      } else {
        ds.forEach((hs, i) => {
          tbody.innerHTML += `
            <tr>
              <td>${i + 1}</td>
              <td>${hs.ten}</td>
              <td>${hs.maSo}</td>
              <td>${hs.soCauDung}</td>
              <td>${hs.tong}</td>
              <td>${hs.diem}</td>
            </tr>
          `;
        });
      }

      document.getElementById("bangKetQua").classList.remove("d-none");
    }

    function xuatFile() {
      const ds = JSON.parse(localStorage.getItem("danhSachKetQua")) || [];
      if (ds.length === 0) {
        alert("Ch∆∞a c√≥ d·ªØ li·ªáu ƒë·ªÉ xu·∫•t.");
        return;
      }

      let text = "K·∫æT QU·∫¢ H·ªåC SINH\n====================\n";
      ds.forEach((hs, i) => {
        text += `${i + 1}. ${hs.ten} - ${hs.maSo} | ƒê√∫ng: ${hs.soCauDung}/${hs.tong} | ƒêi·ªÉm: ${hs.diem}\n`;
      });

      const blob = new Blob([text], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "ketqua_hocsinh.txt";
      link.click();
    }
  </script>
</body>
</html>
